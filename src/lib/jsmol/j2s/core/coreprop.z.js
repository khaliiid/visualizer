Clazz.declarePackage("J.api");Clazz.declareInterface(J.api,"JmolPropertyManager");Clazz.declarePackage("J.viewer");
Clazz.load(["J.api.JmolPropertyManager","java.util.Hashtable"],"J.viewer.PropertyManager","java.lang.Boolean $.Double $.Float java.util.Arrays $.Map JU.BS $.Base64 $.List $.M3 $.P3 $.PT $.SB $.V3 J.modelset.Atom $.BondSet $.LabelToken J.script.SV $.T J.util.BSUtil $.C $.Elements $.Escape $.JmolEdge $.JmolMolecule $.Logger $.Txt J.viewer.Viewer".split(" "),function(){c$=Clazz.decorateAsClass(function(){this.map=this.viewer=null;Clazz.instantialize(this,arguments)},J.viewer,"PropertyManager",null,J.api.JmolPropertyManager);
Clazz.prepareFields(c$,function(){this.map=new java.util.Hashtable});Clazz.makeConstructor(c$,function(){});$_V(c$,"setViewer",function(b){this.viewer=b;for(var c=b=0;b<J.viewer.PropertyManager.propertyTypes.length;b+=3)this.map.put(J.viewer.PropertyManager.propertyTypes[b].toLowerCase(),Integer.$valueOf(c++))},"J.viewer.Viewer");$_V(c$,"getPropertyNumber",function(b){b=this.map.get(null==b?"":b.toLowerCase());return null==b?-1:b.intValue()},"~S");$_V(c$,"getDefaultPropertyParam",function(b){return 0>
b?"":J.viewer.PropertyManager.propertyTypes[3*b+2]},"~N");$_V(c$,"checkPropertyParameter",function(b){b=this.getPropertyNumber(b);b=J.viewer.PropertyManager.getParamType(b);return 0<b.length&&"<atom selection>"!==b},"~S");$_V(c$,"getProperty",function(b,c,d){123!=J.viewer.PropertyManager.propertyTypes.length&&J.util.Logger.warn("propertyTypes is not the right length: "+J.viewer.PropertyManager.propertyTypes.length+" != 123");d=0<=c.indexOf(".")||0<=c.indexOf("[")?this.getModelProperty(c,d):this.getPropertyAsObject(c,
d,b);if(null==b)return d;var a=b.equalsIgnoreCase("readable");a&&(b=J.viewer.PropertyManager.isReadableAsString(c)?"String":"JSON");return b.equalsIgnoreCase("String")?null==d?"":d.toString():a?J.util.Escape.toReadable(c,d):b.equalsIgnoreCase("JSON")?"{"+JU.PT.toJSON(c,d)+"}":d},"~S,~S,~O");$_M(c$,"getModelProperty",($fz=function(b,c){b=b.$replace("]"," ").$replace("["," ").$replace("."," ");b=JU.PT.simpleReplace(b,"  "," ");var d=JU.PT.split(JU.PT.trim(b," ")," "),a=Array(d.length);b=d[0];for(var e,
f=1;f<d.length;f++)a[f]=-2147483648!=(e=JU.PT.parseInt(d[f]))?J.script.SV.newScriptVariableInt(e):J.script.SV.newVariable(4,d[f]);return this.extractProperty(this.getProperty(null,b,c),a,1)},$fz.isPrivate=!0,$fz),"~S,~O");$_V(c$,"extractProperty",function(b,c,d){if(d>=c.length)return b;var a,e=c[d++];switch(e.tok){case 2:a=e.asInt()-1;if(Clazz.instanceOf(b,JU.List))return 0>a&&(a+=b.size()),0<=a&&a<b.size()?this.extractProperty(b.get(a),c,d):"";if(Clazz.instanceOf(b,JU.M3))return b=[[b.m00,b.m01,
b.m02],[b.m10,b.m11,b.m12],[b.m20,b.m21,b.m22]],0>a&&(a+=3),0<=a&&3>a?this.extractProperty(b,c,--d):"";if(JU.PT.isAI(b))return 0>a&&(a+=b.length),0<=a&&a<b.length?Integer.$valueOf(b[a]):"";if(JU.PT.isAD(b))return 0>a&&(a+=b.length),0<=a&&a<b.length?Double.$valueOf(b[a]):"";if(JU.PT.isAF(b))return 0>a&&(a+=b.length),0<=a&&a<b.length?Float.$valueOf(b[a]):"";if(JU.PT.isAII(b)||JU.PT.isAFF(b))return 0>a&&(a+=b.length),0<=a&&a<b.length?this.extractProperty(b[a],c,d):"";if(JU.PT.isAS(b)||Clazz.instanceOf(b,
Array))return 0>a&&(a+=b.length),0<=a&&a<b.length?b[a]:"";break;case 4:var f=e.asString();if(Clazz.instanceOf(b,java.util.Map)){if(f.equalsIgnoreCase("keys")){f=new JU.List;for(e=b.keySet().iterator();e.hasNext()&&((a=e.next())||1);)f.addLast(a);return this.extractProperty(f,c,d)}if(!b.containsKey(f))for(e=b.keySet().iterator();e.hasNext()&&((a=e.next())||1);)if(a.equalsIgnoreCase(f)){f=a;break}return b.containsKey(f)?this.extractProperty(b.get(f),c,d):""}if(Clazz.instanceOf(b,JU.List)){e=new JU.List;
d--;for(a=0;a<b.size();a++)f=b.get(a),Clazz.instanceOf(f,java.util.Map)&&e.addLast(this.extractProperty(f,c,d));return e}}return b},"~O,~A,~N");c$.getPropertyName=$_M(c$,"getPropertyName",($fz=function(b){return 0>b?"":J.viewer.PropertyManager.propertyTypes[3*b]},$fz.isPrivate=!0,$fz),"~N");c$.getParamType=$_M(c$,"getParamType",($fz=function(b){return 0>b?"":J.viewer.PropertyManager.propertyTypes[3*b+1]},$fz.isPrivate=!0,$fz),"~N");c$.isReadableAsString=$_M(c$,"isReadableAsString",($fz=function(b){for(var c=
J.viewer.PropertyManager.readableTypes.length;0<=--c;)if(b.equalsIgnoreCase(J.viewer.PropertyManager.readableTypes[c]))return!0;return!1},$fz.isPrivate=!0,$fz),"~S");$_M(c$,"getPropertyAsObject",($fz=function(b,c,d){if(b.equals("tokenList"))return J.script.T.getTokensLike(c);var a=this.getPropertyNumber(b),e=null!=c&&0<c.toString().length;c=e?c:this.getDefaultPropertyParam(a);switch(a){case 0:return this.viewer.getAppletInfo();case 5:return this.viewer.getAnimationInfo();case 13:return this.viewer.getAtomBitSetVector(c);
case 14:return this.getAllAtomInfo(this.viewer.getAtomBitSet(c));case 24:return this.viewer.getAuxiliaryInfo(c);case 15:return this.getAllBondInfo(c);case 25:return this.viewer.getBoundBoxInfo();case 10:return this.viewer.getRotationCenter();case 16:return this.getAllChainInfo(this.viewer.getAtomBitSet(c));case 37:return this.viewer.getProperty("DATA_API","consoleText",null);case 26:return this.viewer.getData(c.toString());case 33:return this.viewer.getErrorMessageUn();case 28:return this.viewer.evaluateExpression(c.toString());
case 20:return this.viewer.getModelExtract(c,!0,!1,"MOL");case 32:return J.viewer.PropertyManager.getFileInfo(this.viewer.getFileData(),c.toString());case 1:return this.viewer.getFullPathName();case 2:return this.viewer.getFileHeader();case 4:case 3:return e?this.viewer.getFileAsString(c.toString()):this.viewer.getCurrentFileAsString();case 27:e=c.toString().toLowerCase();a=b=-1;if(0<=(c=e.indexOf("height=")))b=JU.PT.parseInt(e.substring(c+7));if(0<=(c=e.indexOf("width=")))a=JU.PT.parseInt(e.substring(c+
6));0>a&&0>b?b=a=-1:0>a?a=b:b=a;if(0<=e.indexOf("g64")||0<=e.indexOf("base64"))d="string";c="JPG";0<=e.indexOf("type=")&&(c=JU.PT.getTokens(JU.PT.replaceAllCharacter(e.substring(e.indexOf("type=")+5),";,"," "))[0]);e=Array(1);b=this.viewer.getImageAsBytes(c.toUpperCase(),a,b,-1,e);return null!=e[0]?e[0]:null==d?b:JU.Base64.getBase64(b).toString();case 35:return this.viewer.getShapeProperty(24,"getInfo");case 36:return this.viewer.getShapeProperty(24,"getData");case 40:return this.viewer.getNMRCalculation().getInfo(c.toString());
case 21:return this.viewer.getStatusChanged(c.toString());case 22:return this.viewer;case 38:return this.viewer.getJspecViewProperties(c);case 7:return this.getLigandInfo(this.viewer.getAtomBitSet(c));case 9:return this.viewer.getMeasurementInfo();case 29:return this.viewer.getMenu(c.toString());case 23:return this.viewer.getMessageQueue();case 30:return this.viewer.getMinimizationInfo();case 6:return this.getModelInfo(this.viewer.getAtomBitSet(c));case 18:return this.getMoleculeInfo(this.viewer.getAtomBitSet(c));
case 34:return this.viewer.getMouseInfo();case 11:return this.viewer.getOrientationInfo();case 31:return this.viewer.getPointGroupInfo(c);case 17:return this.getAllPolymerInfo(this.viewer.getAtomBitSet(c));case 39:return this.viewer.getScriptQueueInfo();case 8:return this.viewer.getShapeInfo();case 19:return this.viewer.getStateInfo3(c.toString(),0,0);case 12:return this.viewer.getMatrixRotate()}d=Array(41);for(a=0;41>a;a++){e=J.viewer.PropertyManager.getParamType(a);c=this.getDefaultPropertyParam(a);
var f=J.viewer.PropertyManager.getPropertyName(a);d[a]="X"==f.charAt(0)?"":f+(""!==e?" "+J.viewer.PropertyManager.getParamType(a)+(""!==c?" #default: "+this.getDefaultPropertyParam(a):""):"")}java.util.Arrays.sort(d);e=new JU.SB;e.append("getProperty ERROR\n").append(b).append("?\nOptions include:\n");for(a=0;41>a;a++)0<d[a].length&&e.append("\n getProperty ").append(d[a]);return e.toString()},$fz.isPrivate=!0,$fz),"~S,~O,~S");c$.getFileInfo=$_M(c$,"getFileInfo",function(b,c){var d=new java.util.Hashtable;
if(null==b)return d;var a=null!=c&&0<c.length;if(Clazz.instanceOf(b,java.util.Map))return a?b.get(c):b;var e=JU.PT.split(b,"\n");if(0==e.length||6>e[0].length||" "!=e[0].charAt(6)||!e[0].substring(0,6).equals(e[0].substring(0,6).toUpperCase()))return d.put("fileHeader",b),d;var f="",g=new JU.SB;a&&(c=c.toUpperCase());for(var k="",h=0;h<e.length;h++){var l=e[h];if(!(12>l.length)){var k=l.substring(0,6).trim(),j=l.substring(7,10).trim();k.equals("REMARK")&&(k+=j);if(!k.equals(f)){if(a&&f.equals(c))return g.toString();
a||(d.put(f,g.toString()),g=new JU.SB);f=k}(!a||k.equals(c))&&g.append(l).appendC("\n")}}a||d.put(f,g.toString());return a?k.equals(c)?g.toString():"":d},"~O,~S");$_M(c$,"getMoleculeInfo",function(b){b=this.viewer.getAtomBitSet(b);for(var c=this.viewer.modelSet.getMolecules(),d=new JU.List,a=new JU.BS,e=0;e<c.length;e++){var a=J.util.BSUtil.copy(b),f=c[e];a.and(f.atomList);0<a.length()&&(a=new java.util.Hashtable,a.put("mf",f.getMolecularFormula(!1)),a.put("number",Integer.$valueOf(f.moleculeIndex+
1)),a.put("modelNumber",this.viewer.modelSet.getModelNumberDotted(f.modelIndex)),a.put("numberInModel",Integer.$valueOf(f.indexInModel+1)),a.put("nAtoms",Integer.$valueOf(f.atomCount)),a.put("nElements",Integer.$valueOf(f.nElements)),d.addLast(a))}return d},"~O");$_V(c$,"getModelInfo",function(b){b=this.viewer.getModelBitSet(this.viewer.getAtomBitSet(b),!1);var c=this.viewer.getModelSet(),d=new java.util.Hashtable;d.put("modelSetName",c.modelSetName);d.put("modelCount",Integer.$valueOf(c.modelCount));
d.put("isTainted",Boolean.$valueOf(null!=c.tainted));d.put("canSkipLoad",Boolean.$valueOf(c.canSkipLoad));d.put("modelSetHasVibrationVectors",Boolean.$valueOf(c.modelSetHasVibrationVectors()));null!=c.modelSetProperties&&d.put("modelSetProperties",c.modelSetProperties);d.put("modelCountSelected",Integer.$valueOf(J.util.BSUtil.cardinalityOf(b)));d.put("modelsSelected",b);var a=new JU.List;c.getMolecules();for(var e=b.nextSetBit(0);0<=e;e=b.nextSetBit(e+1)){var f=new java.util.Hashtable;f.put("_ipt",
Integer.$valueOf(e));f.put("num",Integer.$valueOf(c.getModelNumber(e)));f.put("file_model",c.getModelNumberDotted(e));f.put("name",c.getModelName(e));var g=c.getModelTitle(e);null!=g&&f.put("title",g);g=c.getModelFileName(e);null!=g&&f.put("file",g);g=c.getModelAuxiliaryInfoValue(e,"modelID");null!=g&&f.put("id",g);f.put("vibrationVectors",Boolean.$valueOf(this.viewer.modelHasVibrationVectors(e)));g=c.models[e];f.put("atomCount",Integer.$valueOf(g.atomCount));f.put("bondCount",Integer.$valueOf(g.getBondCount()));
f.put("groupCount",Integer.$valueOf(g.getGroupCount()));f.put("moleculeCount",Integer.$valueOf(g.moleculeCount));f.put("polymerCount",Integer.$valueOf(g.getBioPolymerCount()));f.put("chainCount",Integer.$valueOf(c.getChainCountInModel(e,!0)));null!=g.properties&&f.put("modelProperties",g.properties);var k=c.getModelAuxiliaryInfoValue(e,"Energy");null!=k&&f.put("energy",k);f.put("atomCount",Integer.$valueOf(g.atomCount));a.addLast(f)}d.put("models",a);return d},"~O");$_V(c$,"getLigandInfo",function(b){var c=
this.viewer.getAtomBitSet(b),d=this.viewer.getAtomBitSet("solvent");b=new java.util.Hashtable;var a=new JU.List;b.put("ligands",a);var e=this.viewer.modelSet,f=J.util.BSUtil.copyInvert(c,e.atomCount);f.or(d);for(var d=e.atoms,g=c.nextSetBit(0);0<=g;g=c.nextSetBit(g+1))(d[g].isProtein()||d[g].isNucleic())&&f.set(g);c=Array(e.modelCount);for(g=e.modelCount;0<=--g;)c[g]=this.viewer.getModelUndeletedAtomsBitSet(g),c[g].andNot(f);f=J.util.JmolMolecule.getMolecules(d,c,null,f);for(g=0;g<f.length;g++){var c=
f[g].atomList,k=new java.util.Hashtable;a.addLast(k);k.put("atoms",J.util.Escape.eBS(c));for(var h="",l="",j=null,n=0,p=null,m="",q="",s=2147483647,v=2147483647,t=c.nextSetBit(0);0<=t;t=c.nextSetBit(t+1)){var r=d[t];if(j!==r.group){var j=r.group,u=r.getResno(),w=r.getChainID();s!=u-1&&(0!=m.length&&s!=v&&(m+="-"+s),w=-1,v=u);q="/"+e.getModelNumberDotted(r.modelIndex);0!=n&&w!=n&&(m+=":"+p+q);-1==w&&(m+=" "+u);s=u;n=r.getChainID();p=r.getChainIDStr();h+=l+r.getGroup3(!1);l="-"}}m+=(v==s?"":"-"+s)+
(0==n?"":":"+p)+q;k.put("groupNames",h);k.put("residueList",m.substring(1))}return b},"~O");$_V(c$,"getSymmetryInfo",function(b,c,d,a,e,f,g){var k=-1;if(null==b){k=this.viewer.getCurrentModelIndex();if(0>k)return"";b=this.viewer.getModelUndeletedAtomsBitSet(k)}b=b.nextSetBit(0);if(0>b)return"";var k=this.viewer.modelSet.atoms[b].modelIndex,h=this.viewer.modelSet.models[k].biosymmetry;null==h&&(h=this.viewer.modelSet.getUnitCell(k));return null==h?"":h.getSymmetryInfo(this.viewer.modelSet,k,b,h,c,
d,a,e,f,g)},"JU.BS,~S,~N,JU.P3,JU.P3,~S,~N");$_V(c$,"getModelExtract",function(b,c,d,a){var e=a.equalsIgnoreCase("V3000"),f=a.equalsIgnoreCase("SDF"),g=a.equalsIgnoreCase("XYZVIB"),k=a.equalsIgnoreCase("CD"),h=a.equalsIgnoreCase("JSON")||k;a=new JU.SB;var l=this.viewer.modelSet;if(!g&&!h){a.append(d?"Jmol Model Kit":this.viewer.getFullPathName().$replace("\\","/"));d=J.viewer.Viewer.getJmolVersion();a.append("\n__Jmol-").append(d.substring(0,2));var j,n,p,m;m=new Date;d=m.getMonth();j=m.getDate();
n=m.getFullYear();p=m.getHours();m=m.getMinutes();J.util.Txt.rightJustify(a,"_00",""+(1+d));J.util.Txt.rightJustify(a,"00",""+j);a.append((""+n).substring(2,4));J.util.Txt.rightJustify(a,"00",""+p);J.util.Txt.rightJustify(a,"00",""+m);a.append("3D 1   1.00000     0.00000     0");a.append("\nJmol version ").append(J.viewer.Viewer.getJmolVersion()).append(" EXTRACT: ").append(J.util.Escape.eBS(b)).append("\n")}d=J.util.BSUtil.copy(b);n=l.atoms;for(j=b.nextSetBit(0);0<=j;j=b.nextSetBit(j+1))c&&n[j].isDeleted()&&
d.clear(j);p=J.viewer.PropertyManager.getCovalentBondsForAtoms(l.bonds,l.bondCount,d);if(!g&&0==d.cardinality())return"";b=!0;c=c?this.viewer.getRotationQuaternion():null;if(f){n=a.toString();a=new JU.SB;e=this.viewer.getModelBitSet(d,!0);for(j=e.nextSetBit(0);0<=j;j=e.nextSetBit(j+1)){a.append(n);f=J.util.BSUtil.copy(d);f.and(l.getModelAtomBitSetIncludingDeleted(j,!1));p=J.viewer.PropertyManager.getCovalentBondsForAtoms(l.bonds,l.bondCount,f);if(!(b=this.addMolFile(a,f,p,!1,!1,!1,c)))break;a.append("$$$$\n")}}else if(g){g=
J.modelset.LabelToken.compile(this.viewer,"%-2e %10.5x %10.5y %10.5z %10.5vx %10.5vy %10.5vz\n","\x00",null);k=J.modelset.LabelToken.compile(this.viewer,"%-2e %10.5x %10.5y %10.5z\n","\x00",null);e=this.viewer.getModelBitSet(d,!0);for(j=e.nextSetBit(0);0<=j;j=e.nextSetBit(j+1))if(f=J.util.BSUtil.copy(d),f.and(l.getModelAtomBitSetIncludingDeleted(j,!1)),0!=f.cardinality()){a.appendI(f.cardinality()).appendC("\n");c=l.models[j].properties;a.append("Model["+(j+1)+"]: ");if(null!=l.frameTitles[j]&&0<
l.frameTitles[j].length)a.append(l.frameTitles[j].$replace("\n"," "));else if(null==c)a.append("Jmol "+J.viewer.Viewer.getJmolVersion());else{h=new JU.SB;p=c.propertyNames();for(m=null;p.hasMoreElements();){var q=p.nextElement();q.equals(".PATH")?m=c.getProperty(q):h.append(";").append(q).append("=").append(c.getProperty(q))}null!=m&&h.append(";PATH=").append(m);m=h.substring(0<h.length()?1:0);a.append(m.$replace("\n"," "))}a.appendC("\n");for(c=f.nextSetBit(0);0<=c;c=f.nextSetBit(c+1))a.append(J.modelset.LabelToken.formatLabelAtomArray(this.viewer,
n[c],null==l.getVibration(c,!1)?k:g,"\x00",null))}}else b=this.addMolFile(a,d,p,e,h,k,c);return b?a.toString():"ERROR: Too many atoms or bonds -- use V3000 format."},"JU.BS,~B,~B,~S");$_M(c$,"addMolFile",($fz=function(b,c,d,a,e,f,g){var k=c.cardinality(),h=d.cardinality();if(!a&&!e&&(999<k||999<h))return!1;var l=this.viewer.modelSet,j=Clazz.newIntArray(l.atomCount,0),n=new JU.P3;a?b.append("  0  0  0  0  0  0            999 V3000"):e?b.append(f?'{"m":{"scaling":[20,-20,20],"a":[':'{"mol":{"a":['):
(J.util.Txt.rightJustify(b,"   ",""+k),J.util.Txt.rightJustify(b,"   ",""+h),b.append("  0  0  0  0              1 V2000"));e||b.append("\n");a&&b.append("M  V30 BEGIN CTAB\nM  V30 COUNTS ").appendI(k).append(" ").appendI(h).append(" 0 0 0\n").append("M  V30 BEGIN ATOM\n");for(var p=new JU.P3,h=c.nextSetBit(0),m=0;0<=h;h=c.nextSetBit(h+1))this.getAtomRecordMOL(l,b,j[h]=++m,l.atoms[h],g,n,p,a,e,f);a?b.append("M  V30 END ATOM\nM  V30 BEGIN BOND\n"):e&&b.append('],"b":[');h=d.nextSetBit(0);for(m=0;0<=
h;h=d.nextSetBit(h+1))this.getBondRecordMOL(b,++m,l.bonds[h],j,a,e,f);a&&b.append("M  V30 END BOND\nM  V30 END CTAB\n");e?b.append("]}}"):b.append("M  END\n");if(!f&&!a&&(d=l.getPartialCharges(),null!=d)){b.append("> <JMOL_PARTIAL_CHARGES>\n").appendI(k).appendC("\n");h=c.nextSetBit(0);for(m=0;0<=h;h=c.nextSetBit(h+1))b.appendI(++m).append(" ").appendF(d[h]).appendC("\n")}return!0},$fz.isPrivate=!0,$fz),"JU.SB,JU.BS,JU.BS,~B,~B,~B,J.util.Quaternion");c$.getCovalentBondsForAtoms=$_M(c$,"getCovalentBondsForAtoms",
($fz=function(b,c,d){for(var a=new JU.BS,e=0;e<c;e++){var f=b[e];d.get(f.atom1.index)&&(d.get(f.atom2.index)&&f.isCovalent())&&a.set(e)}return a},$fz.isPrivate=!0,$fz),"~A,~N,JU.BS");$_M(c$,"getAtomRecordMOL",($fz=function(b,c,d,a,e,f,g,k,h,l){b.models[a.modelIndex].isTrajectory?a.setFractionalCoordPt(g,b.trajectorySteps.get(a.modelIndex)[a.index-b.models[a.modelIndex].firstAtomIndex],!0):f.setT(a);null!=e&&e.transformP2(f,f);b=a.getElementNumber();e=a.isDeleted()?"Xx":J.util.Elements.elementSymbolFromNumber(b);
g=a.getIsotopeNumber();var j=a.getFormalCharge();k?(c.append("M  V30 ").appendI(d).append(" ").append(e).append(" ").appendF(f.x).append(" ").appendF(f.y).append(" ").appendF(f.z).append(" 0"),0!=j&&c.append(" CHG=").appendI(j),0!=g&&c.append(" MASS=").appendI(g),c.append("\n")):h?(1!=d&&c.append(","),c.append("{"),6!=a.getElementNumber()&&c.append('"l":"').append(a.getElementSymbol()).append('",'),0!=j&&c.append('"c":').appendI(j).append(","),0!=g&&g!=J.util.Elements.getNaturalIsotope(b)&&c.append('"m":').appendI(g).append(","),
d=a.x*(l?20:1),f=a.y*(l?-20:1),a=a.z*(l?20:1),c.append('"x":').appendF(d).append(',"y":').appendF(f).append(',"z":').appendF(a).append("}")):(c.append(J.util.Txt.sprintf("%10.5p%10.5p%10.5p","p",[f])),c.append(" ").append(e),1==e.length&&c.append(" "),0<g&&(g-=J.util.Elements.getNaturalIsotope(a.getElementNumber())),c.append(" "),J.util.Txt.rightJustify(c,"  ",""+g),J.util.Txt.rightJustify(c,"   ",""+(0==j?0:4-j)),c.append("  0  0  0  0\n"))},$fz.isPrivate=!0,$fz),"J.modelset.ModelSet,JU.SB,~N,J.modelset.Atom,J.util.Quaternion,JU.P3,JU.P3,~B,~B,~B");
$_M(c$,"getBondRecordMOL",($fz=function(b,c,d,a,e,f,g){var k=a[d.atom1.index];a=a[d.atom2.index];var h=d.getValence();3<h&&(h=1);switch(d.order&-131073){case 515:h=g?2:4;break;case 66:h=g?1:5;break;case 513:h=g?1:6;break;case 514:h=g?2:7;break;case 33:h=g?1:8}e?b.append("M  V30 ").appendI(c).append(" ").appendI(h).append(" ").appendI(k).append(" ").appendI(a).appendC("\n"):f?(1!=c&&b.append(","),b.append('{"b":').appendI(k-1).append(',"e":').appendI(a-1),1!=h&&b.append(',"o":').appendI(h),b.append("}")):
(J.util.Txt.rightJustify(b,"   ",""+k),J.util.Txt.rightJustify(b,"   ",""+a),b.append("  ").appendI(h).append("  0  0  0\n"))},$fz.isPrivate=!0,$fz),"JU.SB,~N,J.modelset.Bond,~A,~B,~B,~B");$_V(c$,"getChimeInfo",function(b,c){switch(b){case 1073741982:break;case 1073741864:return this.getBasePairInfo(c);default:return this.getChimeInfoA(this.viewer.modelSet.atoms,b,c)}var d=new JU.SB;this.viewer.modelSet.models[0].getChimeInfo(d,0);return d.appendC("\n").toString().substring(1)},"~N,JU.BS");$_M(c$,
"getChimeInfoA",($fz=function(b,c,d){var a=new JU.SB;a.append("\n");var e="",f=null,g=null,k=-1,h=0;if(null!=d)for(var l=d.nextSetBit(0);0<=l;l=d.nextSetBit(l+1)){var j=b[l];switch(c){default:return"";case 1114638363:e=j.getInfo();break;case 1141899265:e=""+j.getAtomNumber();break;case 1087373318:e=j.getGroup3(!1);break;case 1087373316:case 1073742120:case 1087373320:var n=j.getChainID(),e=0==n?" ":j.getChainIDStr();255<n&&(e=J.util.Escape.eS(e));switch(c){case 1073742120:e="["+j.getGroup3(!1)+"]"+
j.getSeqcodeString()+":"+e;break;case 1087373320:j.getModelIndex()!=k&&(a.appendC("\n"),h=0,k=j.getModelIndex(),a.append("Model "+j.getModelNumber()),f=g=null);j.getChain()!==f&&(a.appendC("\n"),h=0,f=j.getChain(),a.append("Chain "+e+":\n"),g=null);e=j.getGroup();e!==g&&(0==h++%5&&1<h&&a.appendC("\n"),J.util.Txt.leftJustify(a,"          ","["+j.getGroup3(!1)+"]"+j.getResno()+" "),g=e);continue}}0>a.indexOf("\n"+e+"\n")&&a.append(e).appendC("\n")}1087373320==c&&a.appendC("\n");return a.toString().substring(1)},
$fz.isPrivate=!0,$fz),"~A,~N,JU.BS");$_V(c$,"getModelFileInfo",function(b){for(var c=this.viewer.modelSet,d=new JU.SB,a=0;a<c.modelCount;++a)if(null==b||b.get(a)){var e='["'+c.getModelNumberDotted(a)+'"] = ';d.append("\n\nfile").append(e).append(J.util.Escape.eS(c.getModelFileName(a)));var f=c.getModelAuxiliaryInfoValue(a,"modelID");null!=f&&d.append("\nid").append(e).append(J.util.Escape.eS(f));d.append("\ntitle").append(e).append(J.util.Escape.eS(c.getModelTitle(a)));d.append("\nname").append(e).append(J.util.Escape.eS(c.getModelName(a)));
d.append("\ntype").append(e).append(J.util.Escape.eS(c.getModelFileType(a)))}return d.toString()},"JU.BS");$_M(c$,"getAllAtomInfo",function(b){for(var c=new JU.List,d=b.nextSetBit(0);0<=d;d=b.nextSetBit(d+1))c.addLast(this.getAtomInfoLong(d));return c},"JU.BS");$_M(c$,"getAtomInfoLong",($fz=function(b){var c=this.viewer.modelSet,d=c.atoms[b],a=new java.util.Hashtable;this.viewer.getAtomIdentityInfo(b,a);a.put("element",c.getElementName(b));a.put("elemno",Integer.$valueOf(c.getElementNumber(b)));a.put("x",
Float.$valueOf(d.x));a.put("y",Float.$valueOf(d.y));a.put("z",Float.$valueOf(d.z));a.put("coord",JU.P3.newP(d));null!=c.vibrations&&null!=c.vibrations[b]&&a.put("vibVector",JU.V3.newV(c.vibrations[b]));a.put("bondCount",Integer.$valueOf(d.getCovalentBondCount()));a.put("radius",Float.$valueOf(d.getRasMolRadius()/120));a.put("model",d.getModelNumberForLabel());a.put("shape",J.modelset.Atom.atomPropertyString(this.viewer,d,1087373323));a.put("visible",Boolean.$valueOf(d.isVisible(0)));a.put("clickabilityFlags",
Integer.$valueOf(d.clickabilityFlags));a.put("visibilityFlags",Integer.$valueOf(d.shapeVisibilityFlags));a.put("spacefill",Float.$valueOf(d.getRadius()));var e=J.util.Escape.escapeColor(this.viewer.getColorArgbOrGray(d.colixAtom));null!=e&&a.put("color",e);a.put("colix",Integer.$valueOf(d.colixAtom));(e=d.isTranslucent())&&a.put("translucent",Boolean.$valueOf(e));a.put("formalCharge",Integer.$valueOf(d.getFormalCharge()));a.put("partialCharge",Float.$valueOf(d.getPartialCharge()));e=d.getSurfaceDistance100()/
100;0<=e&&a.put("surfaceDistance",Float.$valueOf(e));if(c.models[d.modelIndex].isBioModel){a.put("resname",d.getGroup3(!1));var e=d.getInsertionCode(),f=d.getResno();0<f&&a.put("resno",Integer.$valueOf(f));0!=e.charCodeAt(0)&&a.put("insertionCode",""+e);a.put("name",c.getAtomName(b));a.put("chain",d.getChainIDStr());a.put("atomID",Integer.$valueOf(d.atomID));a.put("groupID",Integer.$valueOf(d.getGroupID()));"\x00"!=d.altloc&&a.put("altLocation",""+d.altloc);a.put("structure",Integer.$valueOf(d.getProteinStructureType().getId()));
a.put("polymerLength",Integer.$valueOf(d.getPolymerLength()));a.put("occupancy",Integer.$valueOf(d.getOccupancy100()));b=d.getBfactor100();a.put("temp",Integer.$valueOf(Clazz.doubleToInt(b/100)))}return a},$fz.isPrivate=!0,$fz),"~N");$_M(c$,"getAllBondInfo",function(b){var c=new JU.List,d=this.viewer.modelSet,a=d.bondCount,d=d.bonds,e;Clazz.instanceOf(b,String)&&(b=this.viewer.getAtomBitSet(b));if(Clazz.instanceOf(b,Array)){e=b[0];var f=b[1];for(b=0;b<a;b++){var g=d[b].atom1.index,k=d[b].atom2.index;
(e.get(g)&&f.get(k)||f.get(g)&&e.get(k))&&c.addLast(this.getBondInfo(b))}}else if(Clazz.instanceOf(b,J.modelset.BondSet)){e=b;for(b=e.nextSetBit(0);0<=b&&b<a;b=e.nextSetBit(b+1))c.addLast(this.getBondInfo(b))}else if(Clazz.instanceOf(b,JU.BS)){e=b;f=1==e.cardinality()?e.nextSetBit(0):-1;for(b=0;b<a;b++)(0<=f?d[b].atom1.index==f||d[b].atom2.index==f:e.get(d[b].atom1.index)&&e.get(d[b].atom2.index))&&c.addLast(this.getBondInfo(b))}return c},"~O");$_M(c$,"getBondInfo",($fz=function(b){var c=this.viewer.modelSet.bonds[b],
d=c.atom1,a=c.atom2,e=new java.util.Hashtable;e.put("_bpt",Integer.$valueOf(b));b=new java.util.Hashtable;this.viewer.getAtomIdentityInfo(d.index,b);var f=new java.util.Hashtable;this.viewer.getAtomIdentityInfo(a.index,f);e.put("atom1",b);e.put("atom2",f);e.put("order",Float.$valueOf(JU.PT.fVal(J.util.JmolEdge.getBondOrderNumberFromOrder(c.order))));e.put("type",J.util.JmolEdge.getBondOrderNameFromOrder(c.order));e.put("radius",Float.$valueOf(c.mad/2E3));e.put("length_Ang",Float.$valueOf(d.distance(a)));
e.put("visible",Boolean.$valueOf(0!=c.shapeVisibilityFlags));d=J.util.Escape.escapeColor(this.viewer.getColorArgbOrGray(c.colix));null!=d&&e.put("color",d);e.put("colix",Integer.$valueOf(c.colix));J.util.C.isColixTranslucent(c.colix)&&e.put("translucent",Boolean.TRUE);return e},$fz.isPrivate=!0,$fz),"~N");$_M(c$,"getAllChainInfo",function(b){for(var c=new java.util.Hashtable,d=new JU.List,a=this.viewer.modelSet.modelCount,e=0;e<a;++e){var f=new java.util.Hashtable,g=this.getChainInfo(e,b);0<g.size()&&
(f.put("modelIndex",Integer.$valueOf(e)),f.put("chains",g),d.addLast(f))}c.put("models",d);return c},"JU.BS");$_M(c$,"getChainInfo",($fz=function(b,c){for(var d=this.viewer.modelSet.models[b],a=d.getChainCount(!0),e=new JU.List,f=0;f<a;f++){for(var g=d.getChainAt(f),k=new JU.List,h=g.getGroupCount(),l=new java.util.Hashtable,j=0;j<h;j++){var n=g.getGroup(j);c.get(n.firstAtomIndex)&&k.addLast(n.getGroupInfo(j))}k.isEmpty()||(l.put("residues",k),e.addLast(l))}return e},$fz.isPrivate=!0,$fz),"~N,JU.BS");
$_M(c$,"getAllPolymerInfo",function(b){for(var c=new java.util.Hashtable,d=new JU.List,a=this.viewer.modelSet.modelCount,e=this.viewer.modelSet.models,f=0;f<a;++f)e[f].isBioModel&&e[f].getAllPolymerInfo(b,c,d);c.put("models",d);return c},"JU.BS");$_M(c$,"getBasePairInfo",($fz=function(b){var c=new JU.SB,d=new JU.List;this.viewer.modelSet.calcRasmolHydrogenBonds(b,b,d,!0,1,!1,null);for(b=d.size();0<=--b;){var a=d.get(b);J.viewer.PropertyManager.getAtomResidueInfo(c,a.atom1);c.append(" - ");J.viewer.PropertyManager.getAtomResidueInfo(c,
a.atom2);c.append("\n")}return c.toString()},$fz.isPrivate=!0,$fz),"JU.BS");c$.getAtomResidueInfo=$_M(c$,"getAtomResidueInfo",($fz=function(b,c){b.append("[").append(c.getGroup3(!1)).append("]").append(c.getSeqcodeString()).append(":");var d=c.getChainID();b.append(0==d?" ":c.getChainIDStr())},$fz.isPrivate=!0,$fz),"JU.SB,J.modelset.Atom");Clazz.defineStatics(c$,"atomExpression","<atom selection>");c$.propertyTypes=c$.prototype.propertyTypes="appletInfo;;;fileName;;;fileHeader;;;fileContents;<pathname>;;fileContents;;;animationInfo;;;modelInfo;<atom selection>;{*};ligandInfo;<atom selection>;{*};shapeInfo;;;measurementInfo;;;centerInfo;;;orientationInfo;;;transformInfo;;;atomList;<atom selection>;(visible);atomInfo;<atom selection>;(visible);bondInfo;<atom selection>;(visible);chainInfo;<atom selection>;(visible);polymerInfo;<atom selection>;(visible);moleculeInfo;<atom selection>;(visible);stateInfo;<state type>;all;extractModel;<atom selection>;(visible);jmolStatus;statusNameList;;jmolViewer;;;messageQueue;;;auxiliaryInfo;<atom selection>;{*};boundBoxInfo;;;dataInfo;<data type>;types;image;<width=www,height=hhh>;;evaluate;<expression>;;menu;<type>;current;minimizationInfo;;;pointGroupInfo;<atom selection>;(visible);fileInfo;<type>;;errorMessage;;;mouseInfo;;;isosurfaceInfo;;;isosurfaceData;;;consoleText;;;JSpecView;<key>;;scriptQueueInfo;;;nmrInfo;<elementSymbol> or 'all' or 'shifts';all".split(";");
Clazz.defineStatics(c$,"PROP_APPLET_INFO",0,"PROP_FILENAME",1,"PROP_FILEHEADER",2,"PROP_FILECONTENTS_PATH",3,"PROP_FILECONTENTS",4,"PROP_ANIMATION_INFO",5,"PROP_MODEL_INFO",6,"PROP_LIGAND_INFO",7,"PROP_SHAPE_INFO",8,"PROP_MEASUREMENT_INFO",9,"PROP_CENTER_INFO",10,"PROP_ORIENTATION_INFO",11,"PROP_TRANSFORM_INFO",12,"PROP_ATOM_LIST",13,"PROP_ATOM_INFO",14,"PROP_BOND_INFO",15,"PROP_CHAIN_INFO",16,"PROP_POLYMER_INFO",17,"PROP_MOLECULE_INFO",18,"PROP_STATE_INFO",19,"PROP_EXTRACT_MODEL",20,"PROP_JMOL_STATUS",
21,"PROP_JMOL_VIEWER",22,"PROP_MESSAGE_QUEUE",23,"PROP_AUXILIARY_INFO",24,"PROP_BOUNDBOX_INFO",25,"PROP_DATA_INFO",26,"PROP_IMAGE",27,"PROP_EVALUATE",28,"PROP_MENU",29,"PROP_MINIMIZATION_INFO",30,"PROP_POINTGROUP_INFO",31,"PROP_FILE_INFO",32,"PROP_ERROR_MESSAGE",33,"PROP_MOUSE_INFO",34,"PROP_ISOSURFACE_INFO",35,"PROP_ISOSURFACE_DATA",36,"PROP_CONSOLE_TEXT",37,"PROP_JSPECVIEW",38,"PROP_SCRIPT_QUEUE_INFO",39,"PROP_NMR_INFO",40,"PROP_COUNT",41,"readableTypes"," stateinfo extractmodel filecontents fileheader image menu minimizationInfo".split(" "))});
